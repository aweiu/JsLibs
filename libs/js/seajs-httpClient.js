/*! 作者:阿伟 */
/*! git:https://github.com/328080339/JsLibs.git */
/*! 推荐sealoader模块加载器:https://www.npmjs.com/package/sealoader */
/*! 最后修改于 2016-04-05 13:39:40 */
define(function(require,exports,module){var testUrl="",waiting=require("seajs-waiting"),config=require("/seajs-httpClientConfig"),onchange=function(xmlhttp,onSuccess,onError,redo){xmlhttp.onreadystatechange=function(){if(4==this.readyState)if(exports.showWaitting&&waiting.hide(),200==this.status)try{var isEvalError=!0,rs=eval("("+this.responseText+")");isEvalError=!1,config.onSuccess?config.onSuccess(onSuccess,rs,this.responseText,redo):onSuccess&&onSuccess(rs,this.responseText)}catch(e){if(!isEvalError)throw e;config.onSuccess?config.onSuccess(onSuccess,this.responseText,this.responseText,redo):onSuccess&&onSuccess(this.responseText,this.responseText)}else onError?onError(this.status):config.onError?config.onError(this.status):seajs.use("seajs-common-tip",function(a){a.show("抱歉!服务器异常",!1)})}};exports.showWaitting=!0;var creathttp=function(){return exports.showWaitting&&waiting.show(),window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")};exports.get=function(a,b,c){"/"==a.substring(0,1)&&(a=testUrl+a);var d=creathttp();onchange(d,b,c,function(){exports.get(a,b,c)}),d.open("get",a,!0),d.setRequestHeader("Content-type","text/html;charset=utf-8"),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.setRequestHeader("If-Modified-Since","0"),d.send()},exports.post=function(a,b,c,d){"/"==a.substring(0,1)&&(a=testUrl+a);var e=creathttp();onchange(e,c,d,function(){exports.post(a,b,c,d)}),e.open("post",a,!0),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.setRequestHeader("If-Modified-Since","0"),e.send(b)},exports.syncGet=function(a){"/"==a.substring(0,1)&&(a=testUrl+a);var b=creathttp();b.open("get",a,!1),b.setRequestHeader("Content-type","text/html;charset=utf-8"),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.setRequestHeader("If-Modified-Since","0"),b.send(),exports.rs=b.responseText,exports.showWaitting&&waiting.hide()},exports.syncPost=function(a,b){"/"==a.substring(0,1)&&(a=testUrl+a);var c=creathttp();c.open("post",a,!1),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.setRequestHeader("If-Modified-Since","0"),c.send(b),exports.rs=c.responseText,exports.showWaitting&&waiting.hide()},exports.formatData=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b+=c+"="+a[c]+"&");return b.substring(0,b.length-1)},exports.newInstance=function(){return exports}});